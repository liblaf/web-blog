import{_ as a,X as d,Y as r,Z as e,a0 as o,$ as t,a1 as i,E as l}from"./framework-9435e890.js";const s={},c=e("h2",{id:"environment-setup",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#environment-setup","aria-hidden":"true"},"#"),o(" Environment Setup")],-1),h=e("code",null,"ijkplayer",-1),u={href:"https://github.com/liblaf/ijkplayer",target:"_blank",rel:"noopener noreferrer"},p=e("code",null,"lib-monitor",-1),f={href:"https://github.com/liblaf/lib-monitor",target:"_blank",rel:"noopener noreferrer"},m=e("code",null,"LLVM@9",-1),g={href:"https://formulae.brew.sh/formula/llvm@9",target:"_blank",rel:"noopener noreferrer"},b=e("code",null,"NDK-r14b",-1),_={href:"https://dl.google.com/android/repository/android-ndk-r14b-linux-x86_64.zip",target:"_blank",rel:"noopener noreferrer"},v=e("code",null,"NDK-r21e",-1),x={href:"https://dl.google.com/android/repository/android-ndk-r21e-linux-x86_64.zip",target:"_blank",rel:"noopener noreferrer"},k=e("code",null,"Android Studio 2.3.3",-1),w={href:"https://redirector.gvt1.com/edgedl/android/studio/ide-zips/2.3.3.0/android-studio-ide-162.4069837-linux.zip",target:"_blank",rel:"noopener noreferrer"},y=i(`<ol><li>prepare the environment as shown above</li><li>follow instructions <a href="#get-missing-parts-of-ndk">below</a> to get missing parts of <code>NDK</code></li><li>configure variables in <code>ijkplayer/build.sh</code> and <code>lib-monitor/inserter/Makefile</code> according to your setup</li><li>click <code>AVD Manager</code> and create a device with the following system image:</li></ol><table><thead><tr><th>Release Name</th><th>API Level</th><th>ABI</th><th>Target</th></tr></thead><tbody><tr><td>Nougat</td><td>25</td><td><code>armeabi-v7a</code></td><td>Android 7.1.1 (Google APIs)</td></tr></tbody></table><h3 id="get-missing-parts-of-ndk" tabindex="-1"><a class="header-anchor" href="#get-missing-parts-of-ndk" aria-hidden="true">#</a> Get Missing Parts of <code>NDK</code><sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup></h3><div class="hint-container info"><p class="hint-container-title">Info</p><p>We are going to use <code>NDK-r21e</code>.</p></div><p>Version information is in file <code>\${ANDROID_NDK}/toolchains/llvm/prebuilt/linux-x86_64/AndroidVersion.txt</code>.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>9.0.9
based on r365631c3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,6),N={href:"https://android.googlesource.com/platform/prebuilts/clang/host/linux-x86/+/refs/tags/ndk-r21e/clang-r365631c3/",target:"_blank",rel:"noopener noreferrer"},D={href:"https://android.googlesource.com/platform/prebuilts/clang/host/linux-x86/+archive/refs/tags/ndk-r21e/clang-r365631c3.tar.gz",target:"_blank",rel:"noopener noreferrer"},A=e("li",null,[o("extract the downloaded file and merge it with "),e("code",null,"${ANDROID_NDK}/toolchains/llvm/prebuilt/linux-x86_64"),o(".")],-1),I=i(`<div class="hint-container tip"><p class="hint-container-title">Tips</p><p>You may want to remove <code>clang.real</code> and <code>clang++.real</code> under <code>\${ANDROID_NDK}/toolchains/llvm/prebuilt/linux-x86_64/bin/</code>.</p></div><h2 id="build" tabindex="-1"><a class="header-anchor" href="#build" aria-hidden="true">#</a> Build</h2><ol><li>launch Android Studio, select <code>android/ijkplayer/</code> and import</li><li>install dependencies according to logs from Android Studio</li><li>run the following scripts:</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">bash</span> init-android.sh
<span class="token function">bash</span> build.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">Note</p><p>We choose to use <code>NDK-r21e</code> for <code>ffmpeg</code> and <code>NDK-r14b</code> for anything else. There are both <code>c</code> and <code>c++</code> sources elsewhere. However, the <code>-std=c99</code> option ( configured in <code>Android.mk</code> ) will cause an error in <code>NDK-r21e</code> ( with newer <code>clang++</code> ) but simply a warning in <code>NDK-r14b</code>.</p></div><h2 id="run" tabindex="-1"><a class="header-anchor" href="#run" aria-hidden="true">#</a> Run</h2><ol><li>click <code>Run selected configuration</code> or press <code>shift + F10</code> in Android Studio</li><li>click <code>Sample</code> in Android Emulator</li><li>choose a video from the list and click</li></ol><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>When sliding the video list, the simulator may treat the wheel scroll as a click event, so the safe way is to hold down the mouse and drag.</p></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>Sometimes the player would crash. Just try to reopen the video from the list. I’m currently working for a solution.</p></div><h2 id="debug" tabindex="-1"><a class="header-anchor" href="#debug" aria-hidden="true">#</a> Debug</h2><h3 id="adb" tabindex="-1"><a class="header-anchor" href="#adb" aria-hidden="true">#</a> ADB</h3><p>By default, you may find the executable <code>adb</code> at <code>&quot;\${HOME}/Android/Sdk/platform-tools/adb&quot;</code>. Here are some commonly used <code>adb</code> commands:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>./adb devices <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token comment"># list connected devices (-l for long output)</span>
./adb shell <span class="token comment"># run remote shell command (interactive shell if no command given)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>You can enter interactive shell and <code>cd</code> to <code>/sdcard/</code> to see whether <code>recorder.cov</code> has been created.</p><h3 id="logcat" tabindex="-1"><a class="header-anchor" href="#logcat" aria-hidden="true">#</a> logcat</h3><p>In Android Studio, click <code>6: Android Monitor</code> and click <code>logcat</code> tab to view <code>logcat</code>. In addition, you can change the level of logging and use the search box ( for example <code>&quot;lib-monitor&quot;</code> ) to filter logs.</p><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference" aria-hidden="true">#</a> Reference</h2><hr class="footnotes-sep">`,18),K={class:"footnotes"},S={class:"footnotes-list"},z={id:"footnote1",class:"footnote-item"},V={href:"https://xz.aliyun.com/t/6643",target:"_blank",rel:"noopener noreferrer"},B=e("a",{href:"#footnote-ref1",class:"footnote-backref"},"↩︎",-1);function E(M,R){const n=l("ExternalLinkIcon");return d(),r("div",null,[c,e("ul",null,[e("li",null,[h,o(": "),e("a",u,[o("liblaf/ijkplayer: Android/iOS video player based on FFmpeg n3.4, with MediaCodec, VideoToolbox support."),t(n)])]),e("li",null,[p,o(": "),e("a",f,[o("liblaf/lib-monitor"),t(n)])]),e("li",null,[m,o(": "),e("a",g,[o("llvm@9 — Homebrew Formulae"),t(n)])]),e("li",null,[b,o(": "),e("a",_,[o("android-ndk-r14b-linux-x86_64.zip"),t(n)])]),e("li",null,[v,o(": "),e("a",x,[o("android-ndk-r21e-linux-x86_64.zip"),t(n)])]),e("li",null,[k,o(": "),e("a",w,[o("android-studio-ide-162.4069837-linux.zip"),t(n)])])]),y,e("ol",null,[e("li",null,[o("visit the corresponding source at "),e("a",N,[o("clang-r365631c3 - platform/prebuilts/clang/host/linux-x86 - Git at Google"),t(n)]),o(" and download "),e("a",D,[o("tgz"),t(n)])]),A]),I,e("section",K,[e("ol",S,[e("li",z,[e("p",null,[e("a",V,[o("史上最优雅的 NDK 加载 pass 方案 - 先知社区"),t(n)]),o(),B])])])])])}const j=a(s,[["render",E],["__file","index.html.vue"]]);export{j as default};
